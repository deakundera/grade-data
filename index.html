<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>λ¨ν΄ μ„±μ  μ΅°ν μ‹μ¤ν…</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px; max-width: 1200px; margin: 0 auto;
        }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #333; font-size: 2.5em; margin-bottom: 10px; }
        .header p { color: #666; font-size: 1.1em; }
        .tab-container { display: flex; margin-bottom: 30px; border-bottom: 2px solid #eee; }
        .tab {
            padding: 15px 30px; cursor: pointer; border: none; background: none;
            font-size: 1.1em; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s;
        }
        .tab.active { color: #667eea; border-bottom-color: #667eea; font-weight: bold; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .admin-check {
            background: #fff3cd; border-radius: 15px; padding: 25px; margin-bottom: 25px;
            border-left: 4px solid #ffc107;
        }
        .admin-check h3 { color: #856404; margin-bottom: 15px; font-size: 1.3em; }
        .admin-check p { color: #856404; line-height: 1.6; margin-bottom: 15px; }
        .admin-password {
            width: 100%; padding: 12px; border: 2px solid #ffc107; border-radius: 8px;
            font-size: 1em; margin: 10px 0;
        }
        .admin-btn {
            background: #ffc107; color: #856404; border: none; padding: 12px 24px;
            border-radius: 8px; cursor: pointer; font-size: 1em; font-weight: bold; margin: 5px;
        }
        .admin-btn:hover { background: #e0a800; }
        .setup-section {
            background: #e8f2ff; border-radius: 15px; padding: 25px; margin-bottom: 25px;
            border-left: 4px solid #667eea; display: none;
        }
        .setup-section h3 { color: #333; margin-bottom: 15px; font-size: 1.3em; }
        .setup-section p { color: #666; line-height: 1.6; margin-bottom: 10px; }
        .setup-input {
            width: 100%; padding: 12px; border: 2px solid #667eea; border-radius: 8px;
            font-size: 1em; margin: 10px 0;
        }
        .setup-btn {
            background: #667eea; color: white; border: none; padding: 12px 24px;
            border-radius: 8px; cursor: pointer; font-size: 1em; font-weight: bold; margin: 5px;
        }
        .upload-area {
            border: 3px dashed #ccc; border-radius: 15px; padding: 40px; text-align: center;
            margin: 20px 0; background: #f9f9fa; transition: all 0.3s;
        }
        .upload-area.dragover { border-color: #667eea; background: #e8f2ff; }
        .upload-btn {
            background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none;
            padding: 12px 30px; border-radius: 25px; cursor: pointer; font-size: 1em; margin: 5px;
        }
        .upload-btn:disabled { background: #ccc; cursor: not-allowed; }
        .status {
            margin: 20px 0; padding: 15px; border-radius: 8px; display: none;
        }
        .status.success {
            background: #d4edda; color: #155724; border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
        }
        .status.warning {
            background: #fff3cd; color: #856404; border: 1px solid #ffeaa7;
        }
        .instructions {
            background: #e8f2ff; border-radius: 15px; padding: 25px; margin-bottom: 25px;
            border-left: 4px solid #667eea;
        }
        .instructions h3 { color: #333; margin-bottom: 15px; font-size: 1.3em; }
        .instructions p { color: #666; line-height: 1.6; margin-bottom: 10px; }
        .search-section { margin-bottom: 30px; }
        .search-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .search-input {
            flex: 1; padding: 15px; border: 2px solid #ddd; border-radius: 10px;
            font-size: 1.1em; transition: border-color 0.3s;
        }
        .search-input:focus { outline: none; border-color: #667eea; }
        .search-btn {
            padding: 15px 30px; background: linear-gradient(45deg, #667eea, #764ba2);
            color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 1.1em;
        }
        .search-btn:disabled { background: #ccc; cursor: not-allowed; }
        .student-info {
            background: #e8f2ff; border-radius: 15px; padding: 25px; margin: 25px 0;
            border-left: 5px solid #667eea;
        }
        .student-info h2 { color: #333; margin-bottom: 15px; font-size: 1.6em; }
        .summary-table {
            background: white; border-radius: 15px; padding: 25px; margin: 25px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1); border-left: 5px solid #667eea; overflow-x: auto;
        }
        .summary-table h3 { color: #333; margin-bottom: 20px; font-size: 1.4em; }
        .grade-table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
        .grade-table th {
            background: #f8f9fa; color: #333; font-weight: bold; padding: 12px 8px;
            text-align: center; border: 1px solid #dee2e6;
        }
        .grade-table td { padding: 10px 8px; text-align: center; border: 1px solid #dee2e6; }
        .grade-table tr:nth-child(even) { background: #f8f9fa; }
        .test-name { font-weight: bold; color: #667eea; text-align: left !important; min-width: 80px; }
        .grade-cell { font-weight: bold; font-size: 1.1em; }
        .score-cell { font-weight: bold; color: #333; }
        .absent-cell { color: #999; font-style: italic; }
        .source-cell { font-size: 0.8em; color: #666; }
        .grade-1 { color: #e74c3c; } .grade-2 { color: #f39c12; } .grade-3 { color: #f1c40f; }
        .grade-4 { color: #2ecc71; } .grade-5 { color: #3498db; } .grade-6 { color: #9b59b6; }
        .analysis-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;
            border-radius: 15px; padding: 30px; margin: 30px 0; box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .analysis-section h3 {
            color: white; margin-bottom: 25px; font-size: 1.5em; text-align: center;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .analysis-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px; margin-bottom: 25px;
        }
        .analysis-card {
            background: rgba(255, 255, 255, 0.15); border-radius: 12px; padding: 20px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .analysis-card h4 {
            color: #fff; margin-bottom: 15px; font-size: 1.2em;
            display: flex; align-items: center; gap: 8px;
        }
        .analysis-list { list-style: none; padding: 0; margin: 0; }
        .analysis-list li {
            background: rgba(255, 255, 255, 0.1); margin: 8px 0; padding: 10px 15px;
            border-radius: 8px; border-left: 4px solid #fff; font-size: 0.95em; line-height: 1.4;
        }
        .analysis-summary {
            background: rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 25px;
            margin-top: 25px; border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .analysis-summary h4 {
            color: #fff; margin-bottom: 15px; font-size: 1.3em; text-align: center;
        }
        .prediction-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px; margin-top: 15px;
        }
        .prediction-item {
            background: rgba(255, 255, 255, 0.15); padding: 15px; border-radius: 8px;
            text-align: center; border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .prediction-value {
            font-size: 1.4em; font-weight: bold; color: #fff; margin-bottom: 5px;
        }
        .prediction-label { font-size: 0.9em; color: rgba(255, 255, 255, 0.8); }
        .trend-up { color: #4CAF50; } .trend-down { color: #f44336; }
        .trend-stable { color: #ff9800; } .trend-volatile { color: #9c27b0; }
        .no-results, .no-data {
            text-align: center; color: #666; font-size: 1.2em; margin-top: 40px;
            padding: 40px; background: #f8f9fa; border-radius: 15px;
        }
        @media (max-width: 768px) {
            .container { padding: 20px; }
            .search-box { flex-direction: column; }
            .grade-table { font-size: 0.8em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>π“ λ¨ν΄ μ„±μ  μ΅°ν μ‹μ¤ν…</h1>
            <p>μ •λ™λ―Όκµ­μ–΄λ…Όμ ν•™μ› β€Ά κ³ 2 λ¨μκ³ μ‚¬ μ„±μ  μ΅°ν</p>
        </div>
        
        <div class="tab-container">
            <button class="tab active" onclick="switchTab('student')">π” μ„±μ  μ΅°ν</button>
            <button class="tab" onclick="switchTab('admin')">β™οΈ κ΄€λ¦¬μ</button>
        </div>
        
        <div id="studentTab" class="tab-content active">
            <div class="instructions">
                <h3>π“‹ μ„±μ  μ΅°ν λ°©λ²•</h3>
                <p>β€Ά <strong>μ¶κ²°λ²νΈλ΅ κ²€μƒ‰:</strong> λ³ΈμΈμ 4μλ¦¬ μ¶κ²°λ²νΈλ¥Ό μ…λ ¥ν•μ„Έμ”</p>
                <p>β€Ά μμ‹: 3188, 1234, 2274 λ“±</p>
            </div>
            
            <div class="search-section">
                <div class="search-box">
                    <input type="text" id="searchInput" class="search-input" placeholder="μ¶κ²°λ²νΈλ¥Ό μ…λ ¥ν•μ„Έμ” (μ: 3188)" maxlength="4">
                    <button onclick="searchStudent()" class="search-btn" id="searchBtn">π” μ΅°ν</button>
                </div>
            </div>
            
            <div id="noData" class="no-data">
                <h3>π“‹ λ°μ΄ν„° μ¤€λΉ„ μ¤‘</h3>
                <p>μ„±μ  λ°μ΄ν„°λ¥Ό μ¤€λΉ„ν•κ³  μμµλ‹λ‹¤...</p>
            </div>
            
            <div id="results" style="display: none;">
                <div id="studentInfo"></div>
                <div id="summaryTable"></div>
            </div>
            
            <div id="noResults" class="no-results" style="display: none;">
                <h3>π” κ²€μƒ‰ κ²°κ³Όκ°€ μ—†μµλ‹λ‹¤</h3>
                <p>μ…λ ¥ν•μ‹  μ¶κ²°λ²νΈλ¥Ό λ‹¤μ‹ ν™•μΈν•΄μ£Όμ„Έμ”.</p>
            </div>
        </div>
        
        <!-- κ΄€λ¦¬μ νƒ­ -->
        <div id="adminTab" class="tab-content">
            <!-- κ΄€λ¦¬μ μΈμ¦ μ„Ήμ… -->
            <div id="adminAuthSection" class="admin-check">
                <h3>π” κ΄€λ¦¬μ μΈμ¦</h3>
                <p>κ΄€λ¦¬μ κΈ°λ¥μ„ μ‚¬μ©ν•λ ¤λ©΄ λΉ„λ°€λ²νΈλ¥Ό μ…λ ¥ν•΄μ£Όμ„Έμ”.</p>
                <input type="password" id="adminPassword" class="admin-password" placeholder="κ΄€λ¦¬μ λΉ„λ°€λ²νΈλ¥Ό μ…λ ¥ν•μ„Έμ”" onkeypress="if(event.key==='Enter') checkAdminPassword()">
                <br>
                <button onclick="checkAdminPassword()" class="admin-btn">π”‘ μΈμ¦</button>
                <button onclick="resetAdminAccess()" class="admin-btn" style="background: #dc3545; color: white;">π”„ μ΄κΈ°ν™”</button>
                
                <p style="margin-top: 15px; font-size: 0.9em;">
                    <strong>π“ κ΄€λ¦¬μ λΉ„λ°€λ²νΈ:</strong> teacher123
                </p>
            </div>
            
            <!-- GitHub μ €μ¥μ† μ„¤μ • μ„Ήμ… -->
            <div id="githubSetup" class="setup-section">
                <h3>π”§ GitHub μ €μ¥μ† μ„¤μ •</h3>
                <p><strong>μ²μ μ‚¬μ© μ‹ ν• λ²λ§ μ„¤μ •ν•λ©΄ λ©λ‹λ‹¤!</strong></p>
                <p>1. GitHubμ—μ„ μƒ μ €μ¥μ†λ¥Ό λ§λ“μ„Έμ” (μ: grade-data)</p>
                <p>2. μ €μ¥μ†λ¥Ό PublicμΌλ΅ μ„¤μ •ν•κ³  GitHub Pagesλ¥Ό ν™μ„±ν™”ν•μ„Έμ”</p>
                <p>3. μ•„λμ— μ €μ¥μ† μ •λ³΄λ¥Ό μ…λ ¥ν•μ„Έμ”:</p>
                
                <input type="text" id="githubUsername" class="setup-input" placeholder="GitHub μ‚¬μ©μλ… (μ: myusername)" autocomplete="off">
                <input type="text" id="githubRepo" class="setup-input" placeholder="μ €μ¥μ† μ΄λ¦„ (μ: grade-data)" autocomplete="off">
                <input type="password" id="githubToken" class="setup-input" placeholder="GitHub Personal Access Token (μ„ νƒμ‚¬ν•­)">
                
                <button onclick="saveGitHubConfig()" class="setup-btn">μ„¤μ • μ €μ¥</button>
                <button onclick="testGitHubConnection()" class="setup-btn">μ—°κ²° ν…μ¤νΈ</button>
                
                <p style="margin-top: 15px; font-size: 0.9em;">
                    <strong>π“ GitHub Token λ°κΈ‰ λ°©λ²•:</strong><br>
                    GitHub β†’ Settings β†’ Developer settings β†’ Personal access tokens β†’ Generate new token<br>
                    κ¶ν•: repo (μ „μ²΄ μ €μ¥μ† μ ‘κ·Ό κ¶ν•) μ„ νƒ
                </p>
            </div>
            
            <!-- νμΌ μ—…λ΅λ“ μ„Ήμ… -->
            <div id="uploadSection" style="display: none;">
                <div class="instructions">
                    <h3>β™οΈ κ΄€λ¦¬μ μμ—­</h3>
                    <p>β€Ά μ—‘μ…€ νμΌμ„ μ—…λ΅λ“ν•μ—¬ μ„±μ  λ°μ΄ν„°λ¥Ό GitHubμ— μ €μ¥ν•©λ‹λ‹¤</p>
                    <p>β€Ά μ—…λ΅λ“λ λ°μ΄ν„°λ” λ¨λ“  κΈ°κΈ°μ—μ„ μ ‘κ·Ό κ°€λ¥ν•©λ‹λ‹¤</p>
                    <p>β€Ά μ§€μ› νμΌ ν•μ‹: .xlsx, .xls</p>
                    <p>β€Ά <strong>λ°λ¨ λ²„μ „:</strong> μƒν” λ°μ΄ν„°κ°€ λ―Έλ¦¬ λ΅λ“λμ–΄ μμµλ‹λ‹¤</p>
                </div>
                
                <div class="upload-area" id="uploadArea">
                    <h3>π“ μ—‘μ…€ νμΌ μ—…λ΅λ“</h3>
                    <p>νμΌμ„ λ“λκ·Έμ•¤λ“λ΅­ν•κ±°λ‚ μ•„λ λ²„νΌμ„ ν΄λ¦­ν•μ„Έμ”</p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
                    <button class="upload-btn" onclick="document.getElementById('fileInput').click()">νμΌ μ„ νƒ</button>
                    <button class="upload-btn" onclick="processFileAndUpload()" id="processBtn" disabled>GitHubμ— μ—…λ΅λ“</button>
                </div>
            </div>
            
            <div class="status" id="statusMessage"></div>
        </div>
    </div>

    <script>
        // μƒν” λ°μ΄ν„° (μ‹¤μ λ΅λ” μ„λ²„μ—μ„ κ°€μ Έμ¬ λ°μ΄ν„°)
        var studentByNumber = {
            "3188": {
                name: "κΉ€μ¬λ¨",
                attendanceNumber: "3188",
                grades: {
                    "λ¨ν΄1ν": {
                        grade: 3, score: 72, gradeCut: 75, needScore: 3, source: "2024λ…„ 3μ›” κµμ΅μ²­",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 18, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 8, "λ…μ„(μ‚¬ν)": 8, "λ…μ„(κ³Όν•™)": 12, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 3},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 82, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 33, "λ…μ„(μ‚¬ν)": 32, "λ…μ„(κ³Όν•™)": 46, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 22}
                    },
                    "λ¨ν΄2ν": {
                        grade: 2, score: 83, gradeCut: 78, needScore: -5, source: "2024λ…„ 6μ›” κµμ΅μ²­",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 22, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 12, "λ…μ„(μ‚¬ν)": 0, "λ…μ„(κ³Όν•™)": 12, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 8, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 10},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 100, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 52, "λ…μ„(μ‚¬ν)": 0, "λ…μ„(κ³Όν•™)": 46, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 100}
                    },
                    "λ¨ν΄3ν": {
                        grade: 3, score: 75, gradeCut: 72, needScore: -3, source: "2024λ…„ 9μ›” κµμ΅μ²­",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 20, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 8, "λ…μ„(μ‚¬ν)": 16, "λ…μ„(κ³Όν•™)": 8, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 0},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 91, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 33, "λ…μ„(μ‚¬ν)": 64, "λ…μ„(κ³Όν•™)": 31, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 0}
                    },
                    "λ¨ν΄4ν": {
                        grade: 2, score: 79, gradeCut: 81, needScore: 2, source: "2024λ…„ 11μ›” κµμ΅μ²­",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 13, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 12, "λ…μ„(μ‚¬ν)": 12, "λ…μ„(κ³Όν•™)": 8, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 8, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 6},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 100, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 52, "λ…μ„(μ‚¬ν)": 48, "λ…μ„(κ³Όν•™)": 31, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 60}
                    },
                    "λ¨ν΄5ν": {
                        grade: 4, score: 59, gradeCut: 65, needScore: 6, source: "2025λ…„ μ‚¬μ„¤ λ¨μκ³ μ‚¬",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 8, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 8, "λ…μ„(μ‚¬ν)": 12, "λ…μ„(κ³Όν•™)": 4, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 4},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 62, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 33, "λ…μ„(μ‚¬ν)": 48, "λ…μ„(κ³Όν•™)": 15, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 40}
                    },
                    "λ¨ν΄6ν": {
                        grade: 3, score: 68, gradeCut: 70, needScore: 2, source: "2025λ…„ 1μ›” μ‚¬μ„¤",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 18, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 8, "λ…μ„(μ‚¬ν)": 8, "λ…μ„(κ³Όν•™)": 8, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 3},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 82, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 33, "λ…μ„(μ‚¬ν)": 32, "λ…μ„(κ³Όν•™)": 31, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 30}
                    },
                    "λ¨ν΄7ν": {
                        grade: 2, score: 80, gradeCut: 77, needScore: -3, source: "2025λ…„ 2μ›” μ‚¬μ„¤",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 20, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 12, "λ…μ„(μ‚¬ν)": 12, "λ…μ„(κ³Όν•™)": 8, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 5},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 91, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 52, "λ…μ„(μ‚¬ν)": 48, "λ…μ„(κ³Όν•™)": 31, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 50}
                    },
                    "λ¨ν΄8ν": {
                        grade: 2, score: 78, gradeCut: 76, needScore: -2, source: "2025λ…„ 3μ›” μ‚¬μ„¤",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 22, "λ¬Έλ²•": 8, "λ…μ„(μΈλ¬Έ)": 12, "λ…μ„(μ‚¬ν)": 12, "λ…μ„(κ³Όν•™)": 4, "λ¬Έν•™(ν„λ€μ‹)": 4, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 5},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 100, "λ¬Έλ²•": 36, "λ…μ„(μΈλ¬Έ)": 52, "λ…μ„(μ‚¬ν)": 53, "λ…μ„(κ³Όν•™)": 31, "λ¬Έν•™(ν„λ€μ‹)": 50, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 100}
                    }
                }
            },
            "1234": {
                name: "λ°•μ§€μ",
                attendanceNumber: "1234",
                grades: {
                    "λ¨ν΄1ν": {
                        grade: 1, score: 92, gradeCut: 88, needScore: -4, source: "2024λ…„ 3μ›” κµμ΅μ²­",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 22, "λ¬Έλ²•": 12, "λ…μ„(μΈλ¬Έ)": 16, "λ…μ„(μ‚¬ν)": 12, "λ…μ„(κ³Όν•™)": 12, "λ¬Έν•™(ν„λ€μ‹)": 8, "λ¬Έν•™(ν„λ€μ†μ„¤)": 9, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 9},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 100, "λ¬Έλ²•": 55, "λ…μ„(μΈλ¬Έ)": 67, "λ…μ„(μ‚¬ν)": 48, "λ…μ„(κ³Όν•™)": 46, "λ¬Έν•™(ν„λ€μ‹)": 100, "λ¬Έν•™(ν„λ€μ†μ„¤)": 100, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 67}
                    },
                    "λ¨ν΄2ν": {
                        grade: 1, score: 89, gradeCut: 85, needScore: -4, source: "2024λ…„ 6μ›” κµμ΅μ²­",
                        details: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 22, "λ¬Έλ²•": 10, "λ…μ„(μΈλ¬Έ)": 16, "λ…μ„(μ‚¬ν)": 16, "λ…μ„(κ³Όν•™)": 8, "λ¬Έν•™(ν„λ€μ‹)": 6, "λ¬Έν•™(ν„λ€μ†μ„¤)": 7, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 4, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 0},
                        ratios: {"ν™”λ²•κ³Ό μ‘λ¬Έ": 100, "λ¬Έλ²•": 45, "λ…μ„(μΈλ¬Έ)": 67, "λ…μ„(μ‚¬ν)": 64, "λ…μ„(κ³Όν•™)": 31, "λ¬Έν•™(ν„λ€μ‹)": 75, "λ¬Έν•™(ν„λ€μ†μ„¤)": 78, "λ¬Έν•™(κ³ μ „μ‹κ°€)": 100, "λ¬Έν•™(κ³ μ „μ†μ„¤)": 0}
                    }
                }
            }
        };

        var discoveredTestSheets = ["λ¨ν΄1ν", "λ¨ν΄2ν", "λ¨ν΄3ν", "λ¨ν΄4ν", "λ¨ν΄5ν", "λ¨ν΄6ν", "λ¨ν΄7ν", "λ¨ν΄8ν"];
        var isDataLoaded = true;
        var isAdminAuthenticated = false;

        function switchTab(tabName) {
            var tabs = document.querySelectorAll('.tab');
            var contents = document.querySelectorAll('.tab-content');
            
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
            
            if (tabName === 'student') {
                document.querySelector('.tab').classList.add('active');
                document.getElementById('studentTab').classList.add('active');
            } else if (tabName === 'admin') {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('adminTab').classList.add('active');
                checkAdminAuthStatus();
            }
        }

        function checkAdminPassword() {
            var password = document.getElementById('adminPassword').value.trim();
            
            if (password === 'teacher123') {
                isAdminAuthenticated = true;
                localStorage.setItem('adminAuth', 'true');
                
                document.getElementById('adminAuthSection').style.display = 'none';
                document.getElementById('githubSetup').style.display = 'block';
                
                showStatus('β… κ΄€λ¦¬μ μΈμ¦μ΄ μ™„λ£λμ—μµλ‹λ‹¤!', 'success');
            } else {
                showStatus('β λΉ„λ°€λ²νΈκ°€ μ¬λ°”λ¥΄μ§€ μ•μµλ‹λ‹¤.', 'error');
                document.getElementById('adminPassword').value = '';
            }
        }
        
        function resetAdminAccess() {
            isAdminAuthenticated = false;
            localStorage.removeItem('adminAuth');
            
            document.getElementById('adminAuthSection').style.display = 'block';
            document.getElementById('githubSetup').style.display = 'none';
            document.getElementById('uploadSection').style.display = 'none';
            
            document.getElementById('adminPassword').value = '';
            showStatus('π”„ κ΄€λ¦¬μ μ ‘κ·Όμ΄ μ΄κΈ°ν™”λμ—μµλ‹λ‹¤.', 'warning');
        }
        
        function checkAdminAuthStatus() {
            var savedAuth = localStorage.getItem('adminAuth');
            
            if (savedAuth === 'true') {
                isAdminAuthenticated = true;
                document.getElementById('adminAuthSection').style.display = 'none';
                document.getElementById('githubSetup').style.display = 'block';
            } else {
                isAdminAuthenticated = false;
                document.getElementById('adminAuthSection').style.display = 'block';
                document.getElementById('githubSetup').style.display = 'none';
                document.getElementById('uploadSection').style.display = 'none';
            }
        }

        function saveGitHubConfig() {
            if (!isAdminAuthenticated) {
                showStatus('β κ΄€λ¦¬μ μΈμ¦μ΄ ν•„μ”ν•©λ‹λ‹¤.', 'error');
                return;
            }
            
            var username = document.getElementById('githubUsername').value.trim();
            var repo = document.getElementById('githubRepo').value.trim();
            
            if (!username || !repo) {
                showStatus('GitHub μ‚¬μ©μλ…κ³Ό μ €μ¥μ† μ΄λ¦„μ„ μ…λ ¥ν•΄μ£Όμ„Έμ”.', 'error');
                return;
            }
            
            showStatus('GitHub μ„¤μ •μ΄ μ €μ¥λμ—μµλ‹λ‹¤!', 'success');
            
            document.getElementById('githubSetup').style.display = 'none';
            document.getElementById('uploadSection').style.display = 'block';
        }
        
        function testGitHubConnection() {
            if (!isAdminAuthenticated) {
                showStatus('β κ΄€λ¦¬μ μΈμ¦μ΄ ν•„μ”ν•©λ‹λ‹¤.', 'error');
                return;
            }
            
            var username = document.getElementById('githubUsername').value.trim();
            var repo = document.getElementById('githubRepo').value.trim();
            
            if (!username || !repo) {
                showStatus('μ‚¬μ©μλ…κ³Ό μ €μ¥μ† μ΄λ¦„μ„ λ¨Όμ € μ…λ ¥ν•΄μ£Όμ„Έμ”.', 'error');
                return;
            }
            
            showStatus('β… μ €μ¥μ† μ—°κ²° μ„±κ³µ! (λ°λ¨ λ¨λ“)', 'success');
        }

        function processFileAndUpload() {
            if (!isAdminAuthenticated) {
                showStatus('β κ΄€λ¦¬μ μΈμ¦μ΄ ν•„μ”ν•©λ‹λ‹¤.', 'error');
                return;
            }
            
            showStatus('β… λ°λ¨ λ¨λ“μ—μ„λ” μƒν” λ°μ΄ν„°κ°€ μ‚¬μ©λ©λ‹λ‹¤.', 'success');
        }

        function showStatus(message, type) {
            var statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = 'status ' + type;
            statusDiv.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(function() {
                    statusDiv.style.display = 'none';
                }, 5000);
            }
        }

        function searchStudent() {
            var query = document.getElementById('searchInput').value.trim();
            var resultsDiv = document.getElementById('results');
            var noResultsDiv = document.getElementById('noResults');
            var noDataDiv = document.getElementById('noData');
            
            resultsDiv.style.display = 'none';
            noResultsDiv.style.display = 'none';
            noDataDiv.style.display = 'none';
            
            if (!query) {
                alert('μ¶κ²°λ²νΈλ¥Ό μ…λ ¥ν•΄μ£Όμ„Έμ”.');
                return;
            }
            
            var student = studentByNumber[query];
            
            if (!student) {
                noResultsDiv.style.display = 'block';
                return;
            }
            
            displayStudentInfo(student);
            displaySummaryTable(student);
            resultsDiv.style.display = 'block';
        }

        function displayStudentInfo(student) {
            var studentInfoDiv = document.getElementById('studentInfo');
            var gradeKeys = Object.keys(student.grades);
            var totalTests = discoveredTestSheets.length;
            var attendedTests = gradeKeys.length;
            
            studentInfoDiv.innerHTML = '<div class="student-info">' +
                '<h2>π‘¨β€π“ ' + student.name + '</h2>' +
                '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">' +
                '<div style="display: flex; justify-content: space-between;"><span style="font-weight: 600; color: #555;">μ¶κ²°λ²νΈ:</span><span style="color: #333; font-weight: bold;">' + student.attendanceNumber + '</span></div>' +
                '<div style="display: flex; justify-content: space-between;"><span style="font-weight: 600; color: #555;">μ‘μ‹ ν„ν™©:</span><span style="color: #333; font-weight: bold;">' + attendedTests + '/' + totalTests + 'ν</span></div>' +
                '</div></div>';
        }

        function displaySummaryTable(student) {
            var summaryTableDiv = document.getElementById('summaryTable');
            var allTests = discoveredTestSheets;
            var totalTests = allTests.length;
            
            var tableHtml = '';
            
            // μ „μ²΄ μ„±μ  ν„ν™© ν‘
            tableHtml += '<div class="summary-table">';
            tableHtml += '<h3>π“ μ „μ²΄ μ„±μ  ν„ν™© (' + totalTests + 'κ° μ‹ν—)</h3>';
            tableHtml += '<table class="grade-table">';
            tableHtml += '<thead><tr>';
            tableHtml += '<th class="test-name">μ‹ν—</th>';
            tableHtml += '<th>λ“±κΈ‰</th>';
            tableHtml += '<th>μ μ</th>';
            tableHtml += '<th>λ“±κΈ‰μ»·</th>';
            tableHtml += '<th>μ¶μ²</th>';
            tableHtml += '</tr></thead><tbody>';
            
            for (var i = 0; i < allTests.length; i++) {
                var testName = allTests[i];
                var gradeData = student.grades[testName];
                
                tableHtml += '<tr>';
                tableHtml += '<td class="test-name">' + testName + '</td>';
                
                if (gradeData) {
                    tableHtml += '<td class="grade-cell grade-' + gradeData.grade + '">' + gradeData.grade + '</td>';
                    tableHtml += '<td class="score-cell">' + gradeData.score + '</td>';
                    tableHtml += '<td class="score-cell">' + (gradeData.gradeCut || '-') + '</td>';
                    tableHtml += '<td class="source-cell">' + (gradeData.source || '-') + '</td>';
                } else {
                    tableHtml += '<td class="absent-cell">λ―Έμ‘μ‹</td>';
                    tableHtml += '<td class="absent-cell">-</td>';
                    tableHtml += '<td class="absent-cell">-</td>';
                    tableHtml += '<td class="absent-cell">-</td>';
                }
                
                tableHtml += '</tr>';
            }
            
            tableHtml += '</tbody></table></div>';
            
            // κ³Όλ©λ³„ μ„±μ·¨λ„ λΉ„μ¨ ν„ν™© ν‘
            tableHtml += '<div class="summary-table" style="margin-top: 30px;">';
            tableHtml += '<h3>π“ κ³Όλ©λ³„ μ„±μ·¨λ„ λΉ„μ¨ ν„ν™©</h3>';
            tableHtml += '<div style="overflow-x: auto;">';
            tableHtml += '<table class="grade-table" style="min-width: 1200px; font-size: 0.8em;">';
            tableHtml += '<thead><tr>';
            tableHtml += '<th style="min-width: 80px;">μ‹ν—</th>';
            tableHtml += '<th style="min-width: 50px;">λ“±κΈ‰</th>';
            tableHtml += '<th style="min-width: 50px;">μ μ</th>';
            tableHtml += '<th style="min-width: 60px;">λ“±κΈ‰μ»· ν•„μ”μ μ</th>';
            tableHtml += '<th style="min-width: 80px;">ν™”λ²•κ³Ό μ‘λ¬Έ</th>';
            tableHtml += '<th style="min-width: 60px;">λ¬Έλ²•</th>';
            tableHtml += '<th style="min-width: 80px;">λ…μ„(μΈλ¬Έ)</th>';
            tableHtml += '<th style="min-width: 80px;">λ…μ„(μ‚¬ν)</th>';
            tableHtml += '<th style="min-width: 80px;">λ…μ„(κ³Όν•™)</th>';
            tableHtml += '<th style="min-width: 80px;">λ¬Έν•™(ν„λ€μ‹)</th>';
            tableHtml += '<th style="min-width: 90px;">λ¬Έν•™(ν„λ€μ†μ„¤)</th>';
            tableHtml += '<th style="min-width: 90px;">λ¬Έν•™(κ³ μ „μ‹κ°€)</th>';
            tableHtml += '<th style="min-width: 90px;">λ¬Έν•™(κ³ μ „μ†μ„¤)</th>';
            tableHtml += '<th style="min-width: 70px;">μ‹ν—μ¶μ²</th>';
            tableHtml += '</tr></thead><tbody>';
            
            for (var i = 0; i < allTests.length; i++) {
                var testName = allTests[i];
                var gradeData = student.grades[testName];
                
                tableHtml += '<tr>';
                tableHtml += '<td class="test-name">' + testName + '</td>';
                
                if (gradeData) {
                    tableHtml += '<td class="grade-cell grade-' + gradeData.grade + '">' + gradeData.grade + '</td>';
                    tableHtml += '<td class="score-cell">' + gradeData.score + '</td>';
                    
                    var needScoreDisplay = '';
                    if (gradeData.needScore !== null && gradeData.needScore !== undefined) {
                        needScoreDisplay = gradeData.needScore > 0 ? '(' + gradeData.needScore + ')' : '(' + gradeData.needScore + ')';
                    }
                    tableHtml += '<td class="score-cell">' + needScoreDisplay + '</td>';
                    
                    var subjectOrder = ['ν™”λ²•κ³Ό μ‘λ¬Έ', 'λ¬Έλ²•', 'λ…μ„(μΈλ¬Έ)', 'λ…μ„(μ‚¬ν)', 'λ…μ„(κ³Όν•™)', 
                                       'λ¬Έν•™(ν„λ€μ‹)', 'λ¬Έν•™(ν„λ€μ†μ„¤)', 'λ¬Έν•™(κ³ μ „μ‹κ°€)', 'λ¬Έν•™(κ³ μ „μ†μ„¤)'];
                    
                    for (var j = 0; j < subjectOrder.length; j++) {
                        var targetSubject = subjectOrder[j];
                        var ratio = 0;
                        
                        for (var actualSubject in gradeData.ratios) {
                            if (actualSubject.indexOf(targetSubject.split('(')[0]) !== -1 || 
                                targetSubject.indexOf(actualSubject.split('(')[0]) !== -1) {
                                ratio = gradeData.ratios[actualSubject] || 0;
                                break;
                            }
                        }
                        
                        var ratioColor = ratio >= 90 ? '#e74c3c' : ratio >= 80 ? '#f39c12' : ratio >= 70 ? '#f1c40f' : 
                                        ratio >= 60 ? '#2ecc71' : ratio >= 50 ? '#3498db' : '#95a5a6';
                        var ratioText = ratio > 0 ? ratio + '%' : '-';
                        
                        tableHtml += '<td style="color: ' + ratioColor + '; font-weight: bold; text-align: center;">' + ratioText + '</td>';
                    }
                    
                    tableHtml += '<td class="source-cell">' + (gradeData.source || '-') + '</td>';
                } else {
                    tableHtml += '<td class="absent-cell">λ―Έμ‘μ‹</td>';
                    tableHtml += '<td class="absent-cell">-</td>';
                    tableHtml += '<td class="absent-cell">-</td>';
                    for (var k = 0; k < 9; k++) {
                        tableHtml += '<td class="absent-cell">-</td>';
                    }
                    tableHtml += '<td class="absent-cell">-</td>';
                }
                
                tableHtml += '</tr>';
            }
            
            tableHtml += '</tbody></table></div></div>';
            
            // AI μ„±μ  λ¶„μ„ μ„Ήμ… μ¶”κ°€
            tableHtml += generateStudentAnalysis(student);
            
            summaryTableDiv.innerHTML = tableHtml;
        }

        function generateStudentAnalysis(student) {
            var grades = student.grades;
            var testNames = Object.keys(grades).sort();
            
            if (testNames.length < 2) {
                return '<div class="analysis-section"><h3>π¤– AI μ„±μ  λ¶„μ„</h3><p style="text-align: center; opacity: 0.8;">λ¶„μ„μ„ μ„ν•΄μ„λ” μµμ† 2ν μ΄μƒμ μ„±μ  λ°μ΄ν„°κ°€ ν•„μ”ν•©λ‹λ‹¤.</p></div>';
            }
            
            var scores = [];
            var gradeNums = [];
            for (var i = 0; i < testNames.length; i++) {
                scores.push(grades[testNames[i]].score);
                gradeNums.push(parseInt(grades[testNames[i]].grade));
            }
            
            var maxScore = Math.max.apply(Math, scores);
            var minScore = Math.min.apply(Math, scores);
            var currentScore = scores[scores.length - 1];
            var currentGrade = gradeNums[gradeNums.length - 1];
            
            var subjectAverages = {};
            var subjectTrends = {};
            var subjectData = {};
            
            for (var i = 0; i < testNames.length; i++) {
                var testName = testNames[i];
                var testData = grades[testName];
                if (testData.ratios) {
                    var subjects = Object.keys(testData.ratios);
                    for (var j = 0; j < subjects.length; j++) {
                        var subject = subjects[j];
                        if (!subjectData[subject]) {
                            subjectData[subject] = [];
                        }
                        subjectData[subject].push(testData.ratios[subject]);
                    }
                }
            }
            
            var subjects = Object.keys(subjectData);
            for (var i = 0; i < subjects.length; i++) {
                var subject = subjects[i];
                var values = subjectData[subject];
                var sum = 0;
                for (var j = 0; j < values.length; j++) {
                    sum += values[j];
                }
                subjectAverages[subject] = sum / values.length;
                
                if (values.length >= 2) {
                    var firstValue = values[0];
                    var lastValue = values[values.length - 1];
                    var change = lastValue - firstValue;
                    var variance = Math.max.apply(Math, values) - Math.min.apply(Math, values);
                    
                    if (variance > 30) {
                        subjectTrends[subject] = {type: 'volatile', change: change, variance: variance};
                    } else if (change > 10) {
                        subjectTrends[subject] = {type: 'up', change: change, variance: variance};
                    } else if (change < -10) {
                        subjectTrends[subject] = {type: 'down', change: change, variance: variance};
                    } else {
                        subjectTrends[subject] = {type: 'stable', change: change, variance: variance};
                    }
                }
            }
            
            var sortedSubjects = subjects.sort(function(a, b) {
                return subjectAverages[b] - subjectAverages[a];
            });
            var strongSubjects = sortedSubjects.slice(0, 3);
            var weakSubjects = sortedSubjects.slice(-3).reverse();
            
            var targetScore = currentGrade > 1 ? Math.ceil((currentScore + 15) / 5) * 5 : 90;
            var neededPoints = Math.max(0, targetScore - currentScore);
            
            var analysisHtml = '<div class="analysis-section">';
            analysisHtml += '<h3>π¤– AI μ„±μ  λ¶„μ„ λ¦¬ν¬νΈ</h3>';
            
            analysisHtml += '<div class="analysis-grid">';
            
            // ν„μ¬ μ„±μ  ν„ν™©
            analysisHtml += '<div class="analysis-card">';
            analysisHtml += '<h4>π“ ν„μ¬ μ„±μ  ν„ν™©</h4>';
            analysisHtml += '<ul class="analysis-list">';
            analysisHtml += '<li><strong>μ‘μ‹ ν„ν™©:</strong> ' + testNames.length + 'ν λ¨μκ³ μ‚¬</li>';
            analysisHtml += '<li><strong>μµκ³  μ„±μ :</strong> ' + Math.min.apply(Math, gradeNums) + 'λ“±κΈ‰ ' + maxScore + 'μ </li>';
            analysisHtml += '<li><strong>μµμ € μ„±μ :</strong> ' + Math.max.apply(Math, gradeNums) + 'λ“±κΈ‰ ' + minScore + 'μ </li>';
            analysisHtml += '<li><strong>ν„μ¬ λ“±κΈ‰:</strong> ' + currentGrade + 'λ“±κΈ‰ ' + currentScore + 'μ </li>';
            analysisHtml += '</ul></div>';
            
            // κ°•μ  κ³Όλ©
            analysisHtml += '<div class="analysis-card">';
            analysisHtml += '<h4>π’ κ°•μ  κ³Όλ© λ¶„μ„</h4>';
            analysisHtml += '<ul class="analysis-list">';
            for (var i = 0; i < Math.min(3, strongSubjects.length); i++) {
                var subject = strongSubjects[i];
                analysisHtml += '<li><strong>' + (i + 1) + '. ' + subject + ':</strong> ν‰κ·  ' + subjectAverages[subject].toFixed(1) + '%</li>';
            }
            analysisHtml += '</ul></div>';
            
            // κ°μ„  ν•„μ” κ³Όλ©
            analysisHtml += '<div class="analysis-card">';
            analysisHtml += '<h4>π“ κ°μ„  ν•„μ” κ³Όλ©</h4>';
            analysisHtml += '<ul class="analysis-list">';
            for (var i = 0; i < Math.min(3, weakSubjects.length); i++) {
                var subject = weakSubjects[i];
                analysisHtml += '<li><strong>' + (i + 1) + '. ' + subject + ':</strong> ν‰κ·  ' + subjectAverages[subject].toFixed(1) + '%</li>';
            }
            analysisHtml += '</ul></div>';
            
            // μ¶”μ„Έ λ¶„μ„
            analysisHtml += '<div class="analysis-card">';
            analysisHtml += '<h4>π“ λΉ„μ¨ μ¶”μ΄ λ¶„μ„</h4>';
            analysisHtml += '<ul class="analysis-list">';
            
            var trendGroups = {up: [], down: [], stable: [], volatile: []};
            var trendSubjects = Object.keys(subjectTrends);
            for (var i = 0; i < trendSubjects.length; i++) {
                var subject = trendSubjects[i];
                var trend = subjectTrends[subject];
                trendGroups[trend.type].push({
                    subject: subject,
                    change: trend.change,
                    variance: trend.variance
                });
            }
            
            if (trendGroups.up.length > 0) {
                var upList = [];
                for (var i = 0; i < trendGroups.up.length; i++) {
                    var item = trendGroups.up[i];
                    upList.push(item.subject + ' (+' + item.change.toFixed(0) + '%)');
                }
                analysisHtml += '<li class="trend-up"><strong>μƒμΉ μ¶”μ„Έ:</strong> ' + upList.join(', ') + '</li>';
            }
            
            if (trendGroups.down.length > 0) {
                var downList = [];
                for (var i = 0; i < trendGroups.down.length; i++) {
                    var item = trendGroups.down[i];
                    downList.push(item.subject + ' (' + item.change.toFixed(0) + '%)');
                }
                analysisHtml += '<li class="trend-down"><strong>ν•λ½ μ¶”μ„Έ:</strong> ' + downList.join(', ') + '</li>';
            }
            
            if (trendGroups.volatile.length > 0) {
                var volatileList = [];
                for (var i = 0; i < trendGroups.volatile.length; i++) {
                    var item = trendGroups.volatile[i];
                    volatileList.push(item.subject + ' (λ³€λ™ν­: ' + item.variance.toFixed(0) + '%)');
                }
                analysisHtml += '<li class="trend-volatile"><strong>λ³€λ™μ„± ν° κ³Όλ©:</strong> ' + volatileList.join(', ') + '</li>';
            }
            
            if (trendGroups.stable.length > 0) {
                var stableList = [];
                for (var i = 0; i < trendGroups.stable.length; i++) {
                    stableList.push(trendGroups.stable[i].subject);
                }
                analysisHtml += '<li class="trend-stable"><strong>μ•μ •μ  κ³Όλ©:</strong> ' + stableList.join(', ') + '</li>';
            }
            
            analysisHtml += '</ul></div>';
            
            // μ„±μ  ν–¥μƒ μ „λµ
            analysisHtml += '<div class="analysis-card">';
            analysisHtml += '<h4>π― μ„±μ  ν–¥μƒ μ „λµ</h4>';
            analysisHtml += '<ul class="analysis-list">';
            
            var prioritySubjects = weakSubjects.slice(0, 2);
            if (trendGroups.down.length > 0) {
                prioritySubjects.push(trendGroups.down[0].subject);
                var uniquePriority = [];
                for (var i = 0; i < prioritySubjects.length; i++) {
                    if (uniquePriority.indexOf(prioritySubjects[i]) === -1) {
                        uniquePriority.push(prioritySubjects[i]);
                    }
                }
                prioritySubjects = uniquePriority;
            }
            
            analysisHtml += '<li><strong>μ°μ„ μμ„ λ³΄μ™„:</strong> ' + prioritySubjects.join(', ') + '</li>';
            
            if (strongSubjects.length > 0) {
                analysisHtml += '<li><strong>κ°•μ  μ μ§€:</strong> ' + strongSubjects[0] + ' κ³ λ“μ  μ§€μ†</li>';
            }
            
            if (trendGroups.volatile.length > 0) {
                analysisHtml += '<li><strong>μ•μ •ν™” ν•„μ”:</strong> ' + trendGroups.volatile[0].subject + ' λ³€λ™μ„± κ°μ†</li>';
            }
            
            analysisHtml += '</ul></div>';
            analysisHtml += '</div>';
            
            // λ“±κΈ‰ μ „λ§ λ° λ©ν‘
            analysisHtml += '<div class="analysis-summary">';
            analysisHtml += '<h4>π€ λ“±κΈ‰ μƒμΉ μ „λ§ λ° λ©ν‘</h4>';
            analysisHtml += '<div class="prediction-grid">';
            
            if (currentGrade > 1) {
                analysisHtml += '<div class="prediction-item">';
                analysisHtml += '<div class="prediction-value">' + (currentGrade - 1) + 'λ“±κΈ‰</div>';
                analysisHtml += '<div class="prediction-label">λ©ν‘ λ“±κΈ‰</div>';
                analysisHtml += '</div>';
                
                analysisHtml += '<div class="prediction-item">';
                analysisHtml += '<div class="prediction-value">' + targetScore + 'μ </div>';
                analysisHtml += '<div class="prediction-label">λ©ν‘ μ μ</div>';
                analysisHtml += '</div>';
                
                analysisHtml += '<div class="prediction-item">';
                analysisHtml += '<div class="prediction-value">+' + neededPoints + 'μ </div>';
                analysisHtml += '<div class="prediction-label">μ¶”κ°€ ν•„μ”</div>';
                analysisHtml += '</div>';
                
                var expectedTests = Math.ceil(neededPoints / 3) + 1;
                analysisHtml += '<div class="prediction-item">';
                analysisHtml += '<div class="prediction-value">' + expectedTests + 'ν ν›„</div>';
                analysisHtml += '<div class="prediction-label">μμƒ λ‹¬μ„±</div>';
                analysisHtml += '</div>';
            } else {
                analysisHtml += '<div class="prediction-item">';
                analysisHtml += '<div class="prediction-value">1λ“±κΈ‰ μ μ§€</div>';
                analysisHtml += '<div class="prediction-label">ν„μ¬ λ©ν‘</div>';
                analysisHtml += '</div>';
            }
            
            analysisHtml += '</div>';
            
            // μΆ…ν•© λ¶„μ„
            var improvementPotential = '';
            if (trendGroups.up.length > trendGroups.down.length) {
                improvementPotential = 'μƒμΉ λ™λ ¥μ„ λ³΄μ ν•κ³  μμ–΄ κΎΈμ¤€ν• μ„±μ  ν–¥μƒμ΄ κΈ°λ€λ©λ‹λ‹¤.';
            } else if (trendGroups.volatile.length > 0) {
                improvementPotential = 'μΌλ¶€ κ³Όλ©μ μ•μ •ν™”λ¥Ό ν†µν•΄ μ„±μ  μƒμΉμ΄ κ°€λ¥ν•©λ‹λ‹¤.';
            } else {
                improvementPotential = 'κΈ°λ³ΈκΈ° κ°•ν™”λ¥Ό ν†µν• μ μ§„μ  ν–¥μƒμ΄ ν•„μ”ν•©λ‹λ‹¤.';
            }
            
            var expectedTests = Math.ceil(neededPoints / 3) + 1;
            
            analysisHtml += '<p style="margin-top: 20px; text-align: center; font-size: 1.1em; line-height: 1.6; opacity: 0.9;">';
            analysisHtml += '<strong>π“ μΆ…ν•© λ¶„μ„:</strong> ' + student.name + ' ν•™μƒμ€ ' + improvementPotential;
            if (strongSubjects.length > 0) {
                analysisHtml += ' ' + strongSubjects[0] + ' μμ—­μ κ°•μ μ„ ν™μ©ν•κ³ ';
            }
            if (weakSubjects.length > 0) {
                analysisHtml += ' ' + weakSubjects[0] + ' μμ—­μ„ μ§‘μ¤‘ λ³΄μ™„ν•λ©΄';
            }
            if (currentGrade > 1) {
                analysisHtml += ' ' + expectedTests + 'ν λ‚΄ ' + (currentGrade - 1) + 'λ“±κΈ‰ λ‹¬μ„±μ΄ μ¶©λ¶„ν κ°€λ¥ν•©λ‹λ‹¤.';
            } else {
                analysisHtml += ' μ§€μ†μ μΈ 1λ“±κΈ‰ μ μ§€κ°€ κ°€λ¥ν•©λ‹λ‹¤.';
            }
            analysisHtml += '</p>';
            
            analysisHtml += '</div></div>';
            
            return analysisHtml;
        }

        // μ΄λ²¤νΈ λ¦¬μ¤λ„ μ„¤μ •
        document.getElementById('searchInput').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
            if (e.target.value.length > 4) {
                e.target.value = e.target.value.slice(0, 4);
            }
        });

        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchStudent();
            }
        });

        // νμ΄μ§€ λ΅λ“ μ‹ λ°μ΄ν„° μ¤€λΉ„ μ™„λ£ ν‘μ‹
        window.onload = function() {
            document.getElementById('noData').innerHTML = '<h3>β… μ„±μ  λ°μ΄ν„° μ¤€λΉ„ μ™„λ£</h3><p>μ¶κ²°λ²νΈλ¥Ό μ…λ ¥ν•μ—¬ μ„±μ μ„ μ΅°νν•μ„Έμ”.</p>';
        };

        // νμΌ μ—…λ΅λ“ κ΄€λ ¨ μ΄λ²¤νΈ λ¦¬μ¤λ„
        var uploadArea = document.getElementById('uploadArea');
        var fileInput = document.getElementById('fileInput');
        var processBtn = document.getElementById('processBtn');
        
        if (uploadArea) {
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                var files = e.dataTransfer.files;
                if (files.length > 0) {
                    fileInput.files = files;
                    processBtn.disabled = false;
                }
            });
        }
        
        if (fileInput) {
            fileInput.addEventListener('change', function() {
                processBtn.disabled = !fileInput.files.length;
            });
        }
    </script>
</body>
</html>
